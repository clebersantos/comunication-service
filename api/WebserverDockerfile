## example: docker build --build-arg NODE_ENV=development --build-arg API_URL=https://api.example.com
## References:
## - https://github.com/ppdeassis/docker-node-nginx-alpine

FROM nginx:1.17-alpine

WORKDIR "/application"

# Reads args and use them to configure the build, setting them as env vars

ARG NODE_ENV
ARG API_URL

ENV NODE_ENV $NODE_ENV
ENV API_URL $API_URL


COPY . /application

RUN rm -rf node_modules \
  && yarn install \
  && yarn cache clean \
  && yarn run build

COPY ./docker/webserver/nginx/nginx.conf /etc/nginx/conf.d/default.conf

EXPOSE 80
